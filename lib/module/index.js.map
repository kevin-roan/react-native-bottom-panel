{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Animated","BackHandler","Dimensions","Easing","Keyboard","PanResponder","TouchableOpacity","View","styles","defaultSliderMaxHeight","get","height","BottomSheet","children","createElement","headerComponent","isOpen","sliderMaxHeight","sliderMinHeight","animation","quad","animationDuration","onOpen","onClose","wrapperStyle","outerContentStyle","innerContentStyle","lineContainerStyle","lineStyle","isPanelVisible","setIsPanelVisible","isPanelOpened","setIsPanelOpened","contentHeight","setContentHeight","panelHeightValue","Value","current","panelOpenedRef","contentHeightRef","togglePanel","undefined","toValue","timing","duration","easing","useNativeDriver","start","prev","toOpened","dismiss","onBackPress","addEventListener","removeEventListener","parentPanResponder","create","onMoveShouldSetPanResponderCapture","onPanResponderRelease","childPanResponder","e","gestureState","dy","_setSize","event","nativeEvent","layout","setValue","_handleScrollEndDrag","contentOffset","y","Error","_extends","onLayout","panHandlers","style","container","maxHeight","transform","translateY","scale","outerContent","onPress","activeOpacity","lineContainer","line","innerContent"],"sources":["index.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\n\nimport {\n  Animated,\n  BackHandler,\n  Dimensions,\n  Easing,\n  Keyboard,\n  PanResponder,\n  TouchableOpacity,\n  View,\n  GestureResponderEvent,\n  LayoutChangeEvent,\n  PanResponderGestureState,\n  ViewStyle,\n  StyleProp,\n} from \"react-native\";\n\nimport styles from \"./styles\";\n\ninterface BottomSheetProps {\n  children?:\n    | React.ReactNode\n    | ((handleScrollEndDrag: (e: any) => void) => React.ReactNode);\n\n  headerComponent?: React.ReactNode;\n  isOpen?: boolean;\n  sliderMaxHeight?: number;\n  sliderMinHeight?: number;\n  animation?: (value: number) => number;\n  animationDuration?: number;\n  onOpen?: () => void;\n  onClose?: () => void;\n  wrapperStyle?: StyleProp<ViewStyle>;\n  outerContentStyle?: StyleProp<ViewStyle>;\n  innerContentStyle?: StyleProp<ViewStyle>;\n  lineContainerStyle?: StyleProp<ViewStyle>;\n  lineStyle?: StyleProp<ViewStyle>;\n}\n\nconst defaultSliderMaxHeight = Dimensions.get(\"window\").height * 0.5;\n\nconst BottomSheet: React.FC<BottomSheetProps> = ({\n  children = <View />,\n  headerComponent = <View />,\n  isOpen = true,\n  sliderMaxHeight = defaultSliderMaxHeight,\n  sliderMinHeight = 50,\n  animation = Easing.quad,\n  animationDuration = 200,\n  onOpen = () => {},\n  onClose = () => {},\n  wrapperStyle = {},\n  outerContentStyle = {},\n  innerContentStyle = {},\n  lineContainerStyle = {},\n  lineStyle = {},\n}) => {\n  const [isPanelVisible, setIsPanelVisible] = useState(isOpen);\n  const [isPanelOpened, setIsPanelOpened] = useState(isOpen);\n  const [contentHeight, setContentHeight] = useState<number | undefined>();\n\n  const panelHeightValue = useRef(new Animated.Value(0)).current;\n\n  const panelOpenedRef = useRef(isPanelOpened);\n  panelOpenedRef.current = isPanelOpened;\n\n  const contentHeightRef = useRef(contentHeight);\n  contentHeightRef.current = contentHeight;\n\n  const togglePanel = useCallback(() => {\n    if (contentHeight === undefined) return;\n    const toValue =\n      panelHeightValue[\"_value\"] === 0 ? contentHeight - sliderMinHeight : 0;\n    Animated.timing(panelHeightValue, {\n      toValue,\n      duration: animationDuration,\n      easing: animation,\n      useNativeDriver: false,\n    }).start(() => {\n      setIsPanelOpened((prev) => {\n        const toOpened = !prev;\n        if (toOpened) {\n          onOpen();\n        } else {\n          onClose();\n          Keyboard.dismiss();\n        }\n        return toOpened;\n      });\n    });\n  }, [\n    animation,\n    animationDuration,\n    sliderMinHeight,\n    contentHeight,\n    onOpen,\n    onClose,\n    panelHeightValue,\n  ]);\n\n  useEffect(() => {\n    const onBackPress = () => {\n      if (panelOpenedRef.current) {\n        togglePanel();\n        return true;\n      }\n      return panelOpenedRef.current;\n    };\n    BackHandler.addEventListener(\"hardwareBackPress\", onBackPress);\n    return () => {\n      BackHandler.removeEventListener(\"hardwareBackPress\", onBackPress);\n    };\n  }, [togglePanel]);\n\n  const parentPanResponder = useRef(\n    PanResponder.create({\n      onMoveShouldSetPanResponderCapture: () => !panelOpenedRef.current,\n      onPanResponderRelease: () => togglePanel(),\n    }),\n  ).current;\n\n  const childPanResponder = useRef(\n    PanResponder.create({\n      onMoveShouldSetPanResponderCapture: (\n        e: GestureResponderEvent,\n        gestureState: PanResponderGestureState,\n      ) => gestureState.dy > 15,\n      onPanResponderRelease: (\n        e: GestureResponderEvent,\n        gestureState: PanResponderGestureState,\n      ) => gestureState.dy > 0 && togglePanel(),\n    }),\n  ).current;\n\n  const _setSize = (event: LayoutChangeEvent) => {\n    const height = event.nativeEvent.layout.height;\n    setContentHeight(height);\n    if (!isOpen && height) {\n      panelHeightValue.setValue(height - sliderMinHeight);\n      setIsPanelVisible(true);\n    }\n  };\n\n  const _handleScrollEndDrag = useCallback(\n    ({ nativeEvent }: any) => {\n      if (nativeEvent.contentOffset.y === 0) {\n        togglePanel();\n      }\n    },\n    [togglePanel],\n  );\n\n  useEffect(() => {\n    setIsPanelVisible(isOpen);\n    setIsPanelOpened(isOpen);\n    if (isOpen && contentHeight !== undefined) {\n      Animated.timing(panelHeightValue, {\n        toValue: 0,\n        duration: animationDuration,\n        easing: animation,\n        useNativeDriver: false,\n      }).start();\n    } else if (contentHeight !== undefined) {\n      panelHeightValue.setValue(contentHeight - sliderMinHeight);\n    }\n  }, [isOpen, contentHeight]);\n\n  if (\n    sliderMinHeight !== undefined &&\n    sliderMaxHeight !== undefined &&\n    sliderMinHeight > sliderMaxHeight\n  ) {\n    throw new Error(\"sliderMinHeight cannot exceed sliderMaxHeight.\");\n  }\n\n  return (\n    <View>\n      {headerComponent}\n\n      <Animated.View\n        onLayout={_setSize}\n        {...parentPanResponder.panHandlers}\n        style={[\n          styles.container,\n          wrapperStyle,\n          { maxHeight: sliderMaxHeight },\n          {\n            transform: [\n              { translateY: panelHeightValue },\n              { scale: isPanelVisible ? 1 : 0 },\n            ],\n          },\n        ]}\n      >\n        <View\n          style={[styles.outerContent, outerContentStyle]}\n          {...childPanResponder.panHandlers}\n        >\n          <TouchableOpacity onPress={togglePanel} activeOpacity={1}>\n            <View style={[styles.lineContainer, lineContainerStyle]}>\n              <View style={[styles.line, lineStyle]} />\n            </View>\n          </TouchableOpacity>\n          <View style={[styles.innerContent, innerContentStyle]}>\n            {typeof children === \"function\"\n              ? children(_handleScrollEndDrag)\n              : children}\n          </View>\n        </View>\n      </Animated.View>\n    </View>\n  );\n};\n\nexport default BottomSheet;\n"],"mappings":"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","ignoreList":[]}