{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_styles","_interopRequireDefault","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_extends","assign","bind","arguments","length","apply","defaultSliderMaxHeight","Dimensions","height","BottomSheet","children","createElement","View","headerComponent","isOpen","sliderMaxHeight","sliderMinHeight","animation","Easing","quad","animationDuration","onOpen","onClose","wrapperStyle","outerContentStyle","innerContentStyle","lineContainerStyle","lineStyle","isPanelVisible","setIsPanelVisible","useState","isPanelOpened","setIsPanelOpened","contentHeight","setContentHeight","panelHeightValue","useRef","Animated","Value","current","panelOpenedRef","contentHeightRef","togglePanel","useCallback","undefined","toValue","timing","duration","easing","useNativeDriver","start","prev","toOpened","Keyboard","dismiss","useEffect","onBackPress","BackHandler","addEventListener","removeEventListener","parentPanResponder","PanResponder","create","onMoveShouldSetPanResponderCapture","onPanResponderRelease","childPanResponder","gestureState","dy","_setSize","event","nativeEvent","layout","setValue","_handleScrollEndDrag","contentOffset","y","Error","onLayout","panHandlers","style","styles","container","maxHeight","transform","translateY","scale","outerContent","TouchableOpacity","onPress","activeOpacity","lineContainer","line","innerContent","_default","exports"],"sources":["index.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\n\nimport {\n  Animated,\n  BackHandler,\n  Dimensions,\n  Easing,\n  Keyboard,\n  PanResponder,\n  TouchableOpacity,\n  View,\n  GestureResponderEvent,\n  LayoutChangeEvent,\n  PanResponderGestureState,\n  ViewStyle,\n  StyleProp,\n} from \"react-native\";\n\nimport styles from \"./styles\";\n\ninterface BottomSheetProps {\n  children?:\n    | React.ReactNode\n    | ((handleScrollEndDrag: (e: any) => void) => React.ReactNode);\n\n  headerComponent?: React.ReactNode;\n  isOpen?: boolean;\n  sliderMaxHeight?: number;\n  sliderMinHeight?: number;\n  animation?: (value: number) => number;\n  animationDuration?: number;\n  onOpen?: () => void;\n  onClose?: () => void;\n  wrapperStyle?: StyleProp<ViewStyle>;\n  outerContentStyle?: StyleProp<ViewStyle>;\n  innerContentStyle?: StyleProp<ViewStyle>;\n  lineContainerStyle?: StyleProp<ViewStyle>;\n  lineStyle?: StyleProp<ViewStyle>;\n}\n\nconst defaultSliderMaxHeight = Dimensions.get(\"window\").height * 0.5;\n\nconst BottomSheet: React.FC<BottomSheetProps> = ({\n  children = <View />,\n  headerComponent = <View />,\n  isOpen = true,\n  sliderMaxHeight = defaultSliderMaxHeight,\n  sliderMinHeight = 50,\n  animation = Easing.quad,\n  animationDuration = 200,\n  onOpen = () => {},\n  onClose = () => {},\n  wrapperStyle = {},\n  outerContentStyle = {},\n  innerContentStyle = {},\n  lineContainerStyle = {},\n  lineStyle = {},\n}) => {\n  const [isPanelVisible, setIsPanelVisible] = useState(isOpen);\n  const [isPanelOpened, setIsPanelOpened] = useState(isOpen);\n  const [contentHeight, setContentHeight] = useState<number | undefined>();\n\n  const panelHeightValue = useRef(new Animated.Value(0)).current;\n\n  const panelOpenedRef = useRef(isPanelOpened);\n  panelOpenedRef.current = isPanelOpened;\n\n  const contentHeightRef = useRef(contentHeight);\n  contentHeightRef.current = contentHeight;\n\n  const togglePanel = useCallback(() => {\n    if (contentHeight === undefined) return;\n    const toValue =\n      panelHeightValue[\"_value\"] === 0 ? contentHeight - sliderMinHeight : 0;\n    Animated.timing(panelHeightValue, {\n      toValue,\n      duration: animationDuration,\n      easing: animation,\n      useNativeDriver: false,\n    }).start(() => {\n      setIsPanelOpened((prev) => {\n        const toOpened = !prev;\n        if (toOpened) {\n          onOpen();\n        } else {\n          onClose();\n          Keyboard.dismiss();\n        }\n        return toOpened;\n      });\n    });\n  }, [\n    animation,\n    animationDuration,\n    sliderMinHeight,\n    contentHeight,\n    onOpen,\n    onClose,\n    panelHeightValue,\n  ]);\n\n  useEffect(() => {\n    const onBackPress = () => {\n      if (panelOpenedRef.current) {\n        togglePanel();\n        return true;\n      }\n      return panelOpenedRef.current;\n    };\n    BackHandler.addEventListener(\"hardwareBackPress\", onBackPress);\n    return () => {\n      BackHandler.removeEventListener(\"hardwareBackPress\", onBackPress);\n    };\n  }, [togglePanel]);\n\n  const parentPanResponder = useRef(\n    PanResponder.create({\n      onMoveShouldSetPanResponderCapture: () => !panelOpenedRef.current,\n      onPanResponderRelease: () => togglePanel(),\n    }),\n  ).current;\n\n  const childPanResponder = useRef(\n    PanResponder.create({\n      onMoveShouldSetPanResponderCapture: (\n        e: GestureResponderEvent,\n        gestureState: PanResponderGestureState,\n      ) => gestureState.dy > 15,\n      onPanResponderRelease: (\n        e: GestureResponderEvent,\n        gestureState: PanResponderGestureState,\n      ) => gestureState.dy > 0 && togglePanel(),\n    }),\n  ).current;\n\n  const _setSize = (event: LayoutChangeEvent) => {\n    const height = event.nativeEvent.layout.height;\n    setContentHeight(height);\n    if (!isOpen && height) {\n      panelHeightValue.setValue(height - sliderMinHeight);\n      setIsPanelVisible(true);\n    }\n  };\n\n  const _handleScrollEndDrag = useCallback(\n    ({ nativeEvent }: any) => {\n      if (nativeEvent.contentOffset.y === 0) {\n        togglePanel();\n      }\n    },\n    [togglePanel],\n  );\n\n  useEffect(() => {\n    setIsPanelVisible(isOpen);\n    setIsPanelOpened(isOpen);\n    if (isOpen && contentHeight !== undefined) {\n      Animated.timing(panelHeightValue, {\n        toValue: 0,\n        duration: animationDuration,\n        easing: animation,\n        useNativeDriver: false,\n      }).start();\n    } else if (contentHeight !== undefined) {\n      panelHeightValue.setValue(contentHeight - sliderMinHeight);\n    }\n  }, [isOpen, contentHeight]);\n\n  if (\n    sliderMinHeight !== undefined &&\n    sliderMaxHeight !== undefined &&\n    sliderMinHeight > sliderMaxHeight\n  ) {\n    throw new Error(\"sliderMinHeight cannot exceed sliderMaxHeight.\");\n  }\n\n  return (\n    <View>\n      {headerComponent}\n\n      <Animated.View\n        onLayout={_setSize}\n        {...parentPanResponder.panHandlers}\n        style={[\n          styles.container,\n          wrapperStyle,\n          { maxHeight: sliderMaxHeight },\n          {\n            transform: [\n              { translateY: panelHeightValue },\n              { scale: isPanelVisible ? 1 : 0 },\n            ],\n          },\n        ]}\n      >\n        <View\n          style={[styles.outerContent, outerContentStyle]}\n          {...childPanResponder.panHandlers}\n        >\n          <TouchableOpacity onPress={togglePanel} activeOpacity={1}>\n            <View style={[styles.lineContainer, lineContainerStyle]}>\n              <View style={[styles.line, lineStyle]} />\n            </View>\n          </TouchableOpacity>\n          <View style={[styles.innerContent, innerContentStyle]}>\n            {typeof children === \"function\"\n              ? children(_handleScrollEndDrag)\n              : children}\n          </View>\n        </View>\n      </Animated.View>\n    </View>\n  );\n};\n\nexport default BottomSheet;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AAEA,IAAAC,YAAA,GAAAD,OAAA;AAgBA,IAAAE,OAAA,GAAAC,sBAAA,CAAAH,OAAA;AAA8B,SAAAG,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,SAAAL,wBAAAK,CAAA,EAAAG,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAT,uBAAA,YAAAA,CAAAK,CAAA,EAAAG,CAAA,SAAAA,CAAA,IAAAH,CAAA,IAAAA,CAAA,CAAAC,UAAA,SAAAD,CAAA,MAAAO,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAR,OAAA,EAAAF,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAS,CAAA,MAAAF,CAAA,GAAAJ,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAE,CAAA,CAAAI,GAAA,CAAAX,CAAA,UAAAO,CAAA,CAAAK,GAAA,CAAAZ,CAAA,GAAAO,CAAA,CAAAM,GAAA,CAAAb,CAAA,EAAAS,CAAA,gBAAAN,CAAA,IAAAH,CAAA,gBAAAG,CAAA,OAAAW,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAG,CAAA,OAAAK,CAAA,IAAAD,CAAA,GAAAS,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAG,CAAA,OAAAK,CAAA,CAAAI,GAAA,IAAAJ,CAAA,CAAAK,GAAA,IAAAN,CAAA,CAAAE,CAAA,EAAAN,CAAA,EAAAK,CAAA,IAAAC,CAAA,CAAAN,CAAA,IAAAH,CAAA,CAAAG,CAAA,WAAAM,CAAA,KAAAT,CAAA,EAAAG,CAAA;AAAA,SAAAgB,SAAA,WAAAA,QAAA,GAAAH,MAAA,CAAAI,MAAA,GAAAJ,MAAA,CAAAI,MAAA,CAAAC,IAAA,eAAAf,CAAA,aAAAN,CAAA,MAAAA,CAAA,GAAAsB,SAAA,CAAAC,MAAA,EAAAvB,CAAA,UAAAG,CAAA,GAAAmB,SAAA,CAAAtB,CAAA,YAAAK,CAAA,IAAAF,CAAA,OAAAW,cAAA,CAAAC,IAAA,CAAAZ,CAAA,EAAAE,CAAA,MAAAC,CAAA,CAAAD,CAAA,IAAAF,CAAA,CAAAE,CAAA,aAAAC,CAAA,KAAAa,QAAA,CAAAK,KAAA,OAAAF,SAAA;AAsB9B,MAAMG,sBAAsB,GAAGC,uBAAU,CAACd,GAAG,CAAC,QAAQ,CAAC,CAACe,MAAM,GAAG,GAAG;AAEpE,MAAMC,WAAuC,GAAGA,CAAC;EAC/CC,QAAQ,gBAAGnC,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI,MAAE,CAAC;EACnBC,eAAe,gBAAGtC,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI,MAAE,CAAC;EAC1BE,MAAM,GAAG,IAAI;EACbC,eAAe,GAAGT,sBAAsB;EACxCU,eAAe,GAAG,EAAE;EACpBC,SAAS,GAAGC,mBAAM,CAACC,IAAI;EACvBC,iBAAiB,GAAG,GAAG;EACvBC,MAAM,GAAGA,CAAA,KAAM,CAAC,CAAC;EACjBC,OAAO,GAAGA,CAAA,KAAM,CAAC,CAAC;EAClBC,YAAY,GAAG,CAAC,CAAC;EACjBC,iBAAiB,GAAG,CAAC,CAAC;EACtBC,iBAAiB,GAAG,CAAC,CAAC;EACtBC,kBAAkB,GAAG,CAAC,CAAC;EACvBC,SAAS,GAAG,CAAC;AACf,CAAC,KAAK;EACJ,MAAM,CAACC,cAAc,EAAEC,iBAAiB,CAAC,GAAG,IAAAC,eAAQ,EAAChB,MAAM,CAAC;EAC5D,MAAM,CAACiB,aAAa,EAAEC,gBAAgB,CAAC,GAAG,IAAAF,eAAQ,EAAChB,MAAM,CAAC;EAC1D,MAAM,CAACmB,aAAa,EAAEC,gBAAgB,CAAC,GAAG,IAAAJ,eAAQ,EAAqB,CAAC;EAExE,MAAMK,gBAAgB,GAAG,IAAAC,aAAM,EAAC,IAAIC,qBAAQ,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAACC,OAAO;EAE9D,MAAMC,cAAc,GAAG,IAAAJ,aAAM,EAACL,aAAa,CAAC;EAC5CS,cAAc,CAACD,OAAO,GAAGR,aAAa;EAEtC,MAAMU,gBAAgB,GAAG,IAAAL,aAAM,EAACH,aAAa,CAAC;EAC9CQ,gBAAgB,CAACF,OAAO,GAAGN,aAAa;EAExC,MAAMS,WAAW,GAAG,IAAAC,kBAAW,EAAC,MAAM;IACpC,IAAIV,aAAa,KAAKW,SAAS,EAAE;IACjC,MAAMC,OAAO,GACXV,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAGF,aAAa,GAAGjB,eAAe,GAAG,CAAC;IACxEqB,qBAAQ,CAACS,MAAM,CAACX,gBAAgB,EAAE;MAChCU,OAAO;MACPE,QAAQ,EAAE3B,iBAAiB;MAC3B4B,MAAM,EAAE/B,SAAS;MACjBgC,eAAe,EAAE;IACnB,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM;MACblB,gBAAgB,CAAEmB,IAAI,IAAK;QACzB,MAAMC,QAAQ,GAAG,CAACD,IAAI;QACtB,IAAIC,QAAQ,EAAE;UACZ/B,MAAM,CAAC,CAAC;QACV,CAAC,MAAM;UACLC,OAAO,CAAC,CAAC;UACT+B,qBAAQ,CAACC,OAAO,CAAC,CAAC;QACpB;QACA,OAAOF,QAAQ;MACjB,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,EAAE,CACDnC,SAAS,EACTG,iBAAiB,EACjBJ,eAAe,EACfiB,aAAa,EACbZ,MAAM,EACNC,OAAO,EACPa,gBAAgB,CACjB,CAAC;EAEF,IAAAoB,gBAAS,EAAC,MAAM;IACd,MAAMC,WAAW,GAAGA,CAAA,KAAM;MACxB,IAAIhB,cAAc,CAACD,OAAO,EAAE;QAC1BG,WAAW,CAAC,CAAC;QACb,OAAO,IAAI;MACb;MACA,OAAOF,cAAc,CAACD,OAAO;IAC/B,CAAC;IACDkB,wBAAW,CAACC,gBAAgB,CAAC,mBAAmB,EAAEF,WAAW,CAAC;IAC9D,OAAO,MAAM;MACXC,wBAAW,CAACE,mBAAmB,CAAC,mBAAmB,EAAEH,WAAW,CAAC;IACnE,CAAC;EACH,CAAC,EAAE,CAACd,WAAW,CAAC,CAAC;EAEjB,MAAMkB,kBAAkB,GAAG,IAAAxB,aAAM,EAC/ByB,yBAAY,CAACC,MAAM,CAAC;IAClBC,kCAAkC,EAAEA,CAAA,KAAM,CAACvB,cAAc,CAACD,OAAO;IACjEyB,qBAAqB,EAAEA,CAAA,KAAMtB,WAAW,CAAC;EAC3C,CAAC,CACH,CAAC,CAACH,OAAO;EAET,MAAM0B,iBAAiB,GAAG,IAAA7B,aAAM,EAC9ByB,yBAAY,CAACC,MAAM,CAAC;IAClBC,kCAAkC,EAAEA,CAClClF,CAAwB,EACxBqF,YAAsC,KACnCA,YAAY,CAACC,EAAE,GAAG,EAAE;IACzBH,qBAAqB,EAAEA,CACrBnF,CAAwB,EACxBqF,YAAsC,KACnCA,YAAY,CAACC,EAAE,GAAG,CAAC,IAAIzB,WAAW,CAAC;EAC1C,CAAC,CACH,CAAC,CAACH,OAAO;EAET,MAAM6B,QAAQ,GAAIC,KAAwB,IAAK;IAC7C,MAAM7D,MAAM,GAAG6D,KAAK,CAACC,WAAW,CAACC,MAAM,CAAC/D,MAAM;IAC9C0B,gBAAgB,CAAC1B,MAAM,CAAC;IACxB,IAAI,CAACM,MAAM,IAAIN,MAAM,EAAE;MACrB2B,gBAAgB,CAACqC,QAAQ,CAAChE,MAAM,GAAGQ,eAAe,CAAC;MACnDa,iBAAiB,CAAC,IAAI,CAAC;IACzB;EACF,CAAC;EAED,MAAM4C,oBAAoB,GAAG,IAAA9B,kBAAW,EACtC,CAAC;IAAE2B;EAAiB,CAAC,KAAK;IACxB,IAAIA,WAAW,CAACI,aAAa,CAACC,CAAC,KAAK,CAAC,EAAE;MACrCjC,WAAW,CAAC,CAAC;IACf;EACF,CAAC,EACD,CAACA,WAAW,CACd,CAAC;EAED,IAAAa,gBAAS,EAAC,MAAM;IACd1B,iBAAiB,CAACf,MAAM,CAAC;IACzBkB,gBAAgB,CAAClB,MAAM,CAAC;IACxB,IAAIA,MAAM,IAAImB,aAAa,KAAKW,SAAS,EAAE;MACzCP,qBAAQ,CAACS,MAAM,CAACX,gBAAgB,EAAE;QAChCU,OAAO,EAAE,CAAC;QACVE,QAAQ,EAAE3B,iBAAiB;QAC3B4B,MAAM,EAAE/B,SAAS;QACjBgC,eAAe,EAAE;MACnB,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC;IACZ,CAAC,MAAM,IAAIjB,aAAa,KAAKW,SAAS,EAAE;MACtCT,gBAAgB,CAACqC,QAAQ,CAACvC,aAAa,GAAGjB,eAAe,CAAC;IAC5D;EACF,CAAC,EAAE,CAACF,MAAM,EAAEmB,aAAa,CAAC,CAAC;EAE3B,IACEjB,eAAe,KAAK4B,SAAS,IAC7B7B,eAAe,KAAK6B,SAAS,IAC7B5B,eAAe,GAAGD,eAAe,EACjC;IACA,MAAM,IAAI6D,KAAK,CAAC,gDAAgD,CAAC;EACnE;EAEA,oBACErG,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI,QACFC,eAAe,eAEhBtC,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAA2D,QAAQ,CAACzB,IAAI,EAAAZ,QAAA;IACZ6E,QAAQ,EAAET;EAAS,GACfR,kBAAkB,CAACkB,WAAW;IAClCC,KAAK,EAAE,CACLC,eAAM,CAACC,SAAS,EAChB1D,YAAY,EACZ;MAAE2D,SAAS,EAAEnE;IAAgB,CAAC,EAC9B;MACEoE,SAAS,EAAE,CACT;QAAEC,UAAU,EAAEjD;MAAiB,CAAC,EAChC;QAAEkD,KAAK,EAAEzD,cAAc,GAAG,CAAC,GAAG;MAAE,CAAC;IAErC,CAAC;EACD,iBAEFrD,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI,EAAAZ,QAAA;IACH+E,KAAK,EAAE,CAACC,eAAM,CAACM,YAAY,EAAE9D,iBAAiB;EAAE,GAC5CyC,iBAAiB,CAACa,WAAW,gBAEjCvG,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAA6G,gBAAgB;IAACC,OAAO,EAAE9C,WAAY;IAAC+C,aAAa,EAAE;EAAE,gBACvDlH,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI;IAACmE,KAAK,EAAE,CAACC,eAAM,CAACU,aAAa,EAAEhE,kBAAkB;EAAE,gBACtDnD,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI;IAACmE,KAAK,EAAE,CAACC,eAAM,CAACW,IAAI,EAAEhE,SAAS;EAAE,CAAE,CACpC,CACU,CAAC,eACnBpD,MAAA,CAAAQ,OAAA,CAAA4B,aAAA,CAACjC,YAAA,CAAAkC,IAAI;IAACmE,KAAK,EAAE,CAACC,eAAM,CAACY,YAAY,EAAEnE,iBAAiB;EAAE,GACnD,OAAOf,QAAQ,KAAK,UAAU,GAC3BA,QAAQ,CAAC+D,oBAAoB,CAAC,GAC9B/D,QACA,CACF,CACO,CACX,CAAC;AAEX,CAAC;AAAC,IAAAmF,QAAA,GAAAC,OAAA,CAAA/G,OAAA,GAEa0B,WAAW","ignoreList":[]}